# tkg_autorobot_commander

CoRE 2025自動ロボットに動作指令を送るプログラム

画像処理によりダメージパネルを認識したり対象物に命中させる際の射出角を算出したりする機能を含む

## 探索対象クラスのメンバ
- 位置座標（2次元）
- 速度（2次元）
- 加速度（2次元）
- 最終存在確認時間
- 識別状態（未確認・敵・その他）
- 最終識別時間

## 各状態のフロー

- 探索状態
  1. 探索対象の位置候補をサブスクライブする
  2. 最終存在確認時間が一定時間（5秒くらい？）経過した探索対象を削除する
  3. 候補と現在の探索対象リストを照合して、距離が0.5m以内の場合に対応する探索対象の位置と最終存在確認時間を更新する
  4. 残った候補を新しい探索対象として登録する
  5. 未確認以外の状態の探索対象で最終識別時間が一定時間（30秒くらい？）経過したものを未確認にする
  6. ポリシー（最初は最も近いものを選択する単純なルール）に従って、未確認・敵状態の探索対象の中から一つ選択して砲口を向ける
     （未確認・敵状態の探索対象が存在しないときは砲口を原点位置に移動させる）
  7. カメラで対象の鎧を認識して探索対象の状態を更新し、最終識別時間も更新する
  8. 対象が敵だった場合、攻撃状態に遷移する
  9. 手順1に戻る

- 攻撃状態
  1. ローラを回転させる
  2. 鎧の位置を検出する（検出できなかったとき、探索状態に遷移する）
  3. 弾倉かき混ぜ始める
  4. 鎧の位置に応じた向きに砲口を向ける
  5. ボールを発射する
  6. 3回発射していた場合探索状態に遷移する
  7. 手順1に戻る

## 状態遷移

- 探索状態 -> 攻撃状態：現在の対象から相手チームの鎧を検出できた
- 攻撃状態 -> 探索状態：ボールを3発発射する or 現在の対象から鎧が検出できなかった